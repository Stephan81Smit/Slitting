<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Coil Slitting Optimization Calculator</title>
    <style>
        .container { max-width: 800px; margin: 20px auto; padding: 20px; }
        .input-group { margin-bottom: 15px; }
        label { display: inline-block; width: 200px; }
        input { width: 120px; padding: 5px; }
        table { width: 100%; margin: 20px 0; border-collapse: collapse; }
        th, td { padding: 8px; border: 1px solid #ddd; text-align: left; }
        button { padding: 8px 15px; margin: 5px; cursor: pointer; }
        .result { margin-top: 20px; padding: 15px; background: #f5f5f5; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Coil Slitting Optimizer</h2>
        
        <div class="input-group">
            <label>Coil Width (mm):</label>
            <input type="number" id="coilWidth" value="1225">
        </div>
        
        <div class="input-group">
            <label>Total Trim (mm):</label>
            <input type="number" id="totalTrim" value="16">
        </div>

        <h3>Slit Sizes</h3>
        <table id="slitTable">
            <thead>
                <tr>
                    <th>Slit Size (mm)</th>
                    <th>Max Quantity</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="number" class="slit-size" value="196"></td>
                    <td><input type="number" class="max-qty" value="3"></td>
                    <td><button onclick="removeRow(this)">Remove</button></td>
                </tr>
            </tbody>
        </table>
        
        <button onclick="addSlitRow()">Add Slit Size</button>
        <button onclick="calculateOptimization()">Calculate</button>

        <div id="results" class="result"></div>
    </div>

    <script>
        function addSlitRow() {
            const tbody = document.querySelector('#slitTable tbody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="number" class="slit-size"></td>
                <td><input type="number" class="max-qty"></td>
                <td><button onclick="removeRow(this)">Remove</button></td>
            `;
            tbody.appendChild(newRow);
        }

        function removeRow(btn) {
            btn.closest('tr').remove();
        }

        function calculateOptimization() {
            // Get input values
            const coilWidth = parseFloat(document.getElementById('coilWidth').value);
            const totalTrim = parseFloat(document.getElementById('totalTrim').value);
            const availableWidth = coilWidth - totalTrim;

            // Collect slit sizes and max quantities
            const slitInputs = Array.from(document.querySelectorAll('.slit-size'));
            const maxQtyInputs = Array.from(document.querySelectorAll('.max-qty'));
            
            const slits = slitInputs.map((input, index) => ({
                size: parseFloat(input.value) || 0,
                maxQty: parseFloat(maxQtyInputs[index].value) || 0
            })).filter(s => s.size > 0);

            // Optimization algorithm
            let bestCombination = [];
            let minWaste = availableWidth;
            let maxUsed = 0;

            // Recursive function to try all combinations
            function tryCombinations(index = 0, current = [], usedWidth = 0) {
                if (index === slits.length) {
                    const waste = availableWidth - usedWidth;
                    if (waste >= 0 && (waste < minWaste || (waste === minWaste && usedWidth > maxUsed))) {
                        minWaste = waste;
                        maxUsed = usedWidth;
                        bestCombination = [...current];
                    }
                    return;
                }

                const slit = slits[index];
                for (let qty = 0; qty <= slit.maxQty; qty++) {
                    current[index] = qty;
                    const newWidth = usedWidth + (qty * slit.size);
                    if (newWidth <= availableWidth) {
                        tryCombinations(index + 1, current, newWidth);
                    }
                }
            }

            tryCombinations();

            // Display results
            const resultsDiv = document.getElementById('results');
            if (bestCombination.length > 0) {
                let html = `<h3>Optimal Slitting Combination</h3>`;
                html += `<p>Available Width: ${availableWidth}mm</p>`;
                html += `<p>Used Width: ${maxUsed}mm</p>`;
                html += `<p>Waste: ${minWaste}mm</p>`;
                html += `<table><tr><th>Slit Size</th><th>Quantity</th></tr>`;
                
                slits.forEach((slit, index) => {
                    html += `<tr><td>${slit.size}mm</td><td>${bestCombination[index]}</td></tr>`;
                });
                
                html += `</table>`;
                resultsDiv.innerHTML = html;
            } else {
                resultsDiv.innerHTML = "No valid combination found";
            }
        }
    </script>
</body>
</html>

